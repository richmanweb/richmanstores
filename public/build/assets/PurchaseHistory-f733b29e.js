import{_ as w,b as k,d as y,f as u,o as h,g,i as s,t as o,h as n,w as l,l as f}from"./app-df9a586a.js";const C={data:()=>({loading:!0,currentPage:1,totalPages:1,orders:[],selectedOrder:{}}),computed:{headers(){return[{title:this.$i18n.t("details"),align:"start",sortable:!1,value:"details"},{title:this.$i18n.t("info"),sortable:!1,value:"info"},{title:this.$i18n.t("amount"),sortable:!1,value:"grand_total"},{title:this.$i18n.t("actions"),sortable:!1,align:"center",value:"actions"}]}},watch:{currentPage(){this.$router.push({query:{...this.$route.query,page:this.currentPage}}).catch(()=>{})}},methods:{...k("cart",["addToCart"]),...y("auth",["updateCartDrawer"]),getProductsCount(t){let e=0;return t.orders.forEach(i=>{e+=i.products.data.length}),e},async getList(){this.loading=!0;const t=await this.call_api("get",`user/orders?page=${this.currentPage}`);t.data.success?(this.orders=t.data.data,this.totalPages=t.data.meta.last_page,this.currentPage=t.data.meta.current_page):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.loading=!1},openOrderDetails(t){this.$router.push({name:"OrderDetails",params:{code:t.code}})},async reOrder(t){t.forEach(e=>{this.multipleShop(e)})},multipleShop(t){t.products.data.forEach(e=>{this.addToCart({variation_id:e.product_variation_id,qty:e.quantity})}),this.checkout()},checkout(){this.$router.push({name:"Checkout"}).catch(t=>{this.$route.name=="Checkout"&&this.updateCartDrawer(!1)})},async invoiceDownload(t){t.orders.forEach(async e=>{const i=await this.call_api("get",`order/invoice-download/${e.id}`);if(i.data.success){const p=i.data.invoice_url,d=document.createElement("a");d.href=p,d.download=i.data.invoice_name,d.click()}else this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})})}},created(){let t=this.$route.query.page||this.currentPage;this.getList(t)}},$={class:"ps-lg-7 pt-4"},b={class:"fs-24 fw-700 opacity-80 mb-5 mt-3"},P={class:"d-block fw-600"},D={class:"opacity-50 fs-13 fw-600"},O={class:"d-block fw-600"},V={key:0,class:"fs-13 opacity-60"},E={class:"d-block fw-600"},q={key:0,class:"text-start"};function x(t,e,i,p,d,r){const c=u("v-btn"),_=u("v-data-table"),v=u("v-pagination");return h(),g("div",$,[s("h1",b,o(t.$t("purchase_history")),1),s("div",null,[n(_,{headers:r.headers,items:t.orders,class:"border px-4 pt-3","loading-text":t.$t("loading_please_wait"),"hide-default-footer":"",loading:t.loading,"item-class":"c-pointer","onClick:row":r.openOrderDetails},{"item.details":l(({item:a})=>[s("span",P,o(a.code),1),s("span",D,o(a.date),1)]),"item.info":l(({item:a})=>[s("span",O,o(r.getProductsCount(a))+" "+o(t.$t("products")),1),t.is_addon_activated("multi_vendor")?(h(),g("span",V,o(t.$t("from"))+" "+o(a.orders.length)+" "+o(t.$t("shops")),1)):f("",!0)]),"item.grand_total":l(({item:a})=>[s("span",E,o(t.format_price(a.grand_total)),1)]),"item.actions":l(({item:a})=>[n(c,{onClick:m=>r.invoiceDownload(a),text:"",size:"small",variant:"flat",class:"text-primary fs-18"},{default:l(()=>e[1]||(e[1]=[s("i",{class:"las la-arrow-circle-down text-primary"},null,-1)])),_:2},1032,["onClick"]),n(c,{onClick:m=>r.reOrder(a.orders),text:"",size:"small",variant:"flat",class:"text-green fs-18"},{default:l(()=>e[2]||(e[2]=[s("i",{class:"las la-sync"},null,-1)])),_:2},1032,["onClick"]),n(c,{onClick:m=>r.openOrderDetails(a),text:"",size:"small",variant:"flat",class:"text-blue fs-18"},{default:l(()=>e[3]||(e[3]=[s("i",{class:"las la-bars"},null,-1)])),_:2},1032,["onClick"])]),_:2},1032,["headers","items","loading-text","loading","onClick:row"]),t.totalPages>1?(h(),g("div",q,[n(v,{modelValue:t.currentPage,"onUpdate:modelValue":[e[0]||(e[0]=a=>t.currentPage=a),r.getList],length:t.totalPages,"prev-icon":"las la-angle-left","next-icon":"las la-angle-right","total-visible":7,elevation:"0",class:"my-4"},null,8,["modelValue","onUpdate:modelValue","length"])])):f("",!0)])])}const B=w(C,[["render",x]]);export{B as default};
